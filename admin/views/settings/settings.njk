{% extends "base.njk" %}

{% macro imageSelect(id, name, label, currentValue, images) %}
  <div>
    <label for="{{ id }}" class="admin-label">{{ label }}</label>
    <select id="{{ id }}" name="{{ name }}" class="admin-input">
      {% for img in images %}
        <option value="{{ img }}" {% if img == currentValue %}selected{% endif %}>{{ img }}</option>
      {% endfor %}
    </select>
  </div>
{% endmacro %}

{% block content %}
  <div>
    <!-- Header -->
    <div class="mb-8">
      <h1 class="text-[22px] font-semibold tracking-tight" style="color: var(--color-content); line-height: 1.2;">Settings</h1>
    </div>

    <form id="settings-form" class="flex flex-col gap-0">

      {# ── General ── #}
      <section class="settings-section">
        <h2 class="text-[13px] font-semibold mb-5 flex items-center gap-2" style="color: var(--color-content);">
          <i data-lucide="settings" style="width:14px;height:14px;color:var(--color-accent);"></i>
          General
        </h2>
        <div class="flex flex-col gap-4">
          <div class="grid grid-cols-2 gap-4">
            <div>
              <label for="blogName" class="admin-label">Blog Name</label>
              <input type="text" id="blogName" name="blogName" value="{{ config.site.name }}" class="admin-input">
            </div>
            <div>
              <label for="blogUrl" class="admin-label">Blog URL</label>
              <input type="url" id="blogUrl" name="blogUrl" value="{{ config.site.url }}" class="admin-input">
            </div>
          </div>
          <div class="grid grid-cols-3 gap-4">
            <div>
              <label for="postsPerPage" class="admin-label">Posts Per Page</label>
              <input type="number" id="postsPerPage" name="postsPerPage" value="{{ config.postsPerPage }}" min="1" class="admin-input">
            </div>
            <div>
              <label for="theme" class="admin-label">Theme</label>
              <select id="theme" name="theme" class="admin-input">
                {% for t in themes %}
                  <option value="{{ t }}" {% if t == config.theme %}selected{% endif %}>{{ t }}</option>
                {% endfor %}
              </select>
            </div>
          </div>
          <div class="grid grid-cols-2 gap-4">
            {{ imageSelect("siteLogo", "siteLogo", "Logo", config.site.logo, images) }}
            {{ imageSelect("siteFavicon", "siteFavicon", "Favicon", config.site.favicon, images) }}
          </div>
          <div>
            <label for="homepageHeading" class="admin-label">Homepage Heading</label>
            <input type="text" id="homepageHeading" name="homepageHeading" value="{{ config.homepage.heading }}" class="admin-input">
          </div>
          <div class="grid grid-cols-2 gap-4">
            {{ imageSelect("homepageImg", "homepageImg", "Homepage OG Image", config.homepage.metadata.img, images) }}
          </div>
        </div>
      </section>

      {# ── Footer ── #}
      <section class="settings-section">
        <h2 class="text-[13px] font-semibold mb-5 flex items-center gap-2" style="color: var(--color-content);">
          <i data-lucide="layout-template" style="width:14px;height:14px;color:var(--color-accent);"></i>
          Footer
        </h2>

        <p class="text-[11px] font-semibold mb-3" style="color: var(--color-accent); letter-spacing: 0.06em; text-transform: uppercase;">Social Links</p>
        <div class="flex flex-col gap-2" id="social-links">
          {% for link in config.footer.socialLinks %}
            <div class="flex items-center gap-2 social-link-row">
              <span class="w-28 shrink-0 text-[13px] capitalize" style="color: var(--color-content);">{{ link.name }}</span>
              <input type="text" placeholder="{{ link.placeholder }}" value="{{ link.href }}"
                class="admin-input social-link-href">
            </div>
          {% endfor %}
        </div>
      </section>

      <!-- Save -->
      <div class="pt-2 pb-8">
        <button type="submit"
          class="inline-flex items-center gap-1.5 px-4 py-2 rounded text-[13px] font-medium text-white transition-opacity duration-100"
          style="background-color: var(--color-primary);"
          onmouseover="this.style.opacity='0.88';"
          onmouseout="this.style.opacity='1';"
          >
          <i data-lucide="save" style="width:14px;height:14px;"></i>
          Save Settings
        </button>
      </div>

    </form>
  </div>

  <script type="module" src="/admin/js/settings.js"></script>
{% endblock %}
